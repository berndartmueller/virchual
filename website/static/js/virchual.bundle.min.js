!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?module.exports=s():"function"==typeof define&&define.amd?define(s):(t="undefined"!=typeof globalThis?globalThis:t||self).Virchual=s()}(this,(function(){"use strict";function t(t){t&&(t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault())}class s{constructor(){this.t=[]}s(t,s,i,h={}){t.split(" ").forEach(t=>{i&&i.addEventListener(t,s,h),this.t.push({event:t,i:s,h:i,o:h})})}l(t,s){t.split(" ").forEach(t=>{this.t=this.t.filter(i=>{i&&i.event===t&&i.h===s&&this.u(i)})})}v(t,...s){this.t.forEach(i=>{i.h||i.event.split(".")[0]!==t||i.i(...s)})}m(){this.t.forEach(this.u),this.t=[]}u(t){t.h&&t.h.removeEventListener(t.event,t.i,t.o)}}class i{constructor(t,s){this.imports=t,this.p=s,this.controls=[].slice.call(t.M.g.querySelectorAll(".virchual__control")),t._.s("destroy",()=>{}),this.A=this.T.bind(this),this.mount()}mount(){this.controls.forEach(t=>this.imports._.s("click",this.A,t))}T(s){t(s),"prev"!==s.target.closest("button").dataset.controls?this.imports.M.next():this.imports.M.prev()}}class h{constructor(t,s){this.imports=t,this.p=s,this.p=Object.assign({threshold:300},s),this.imports.M.mount.apply(this.imports.M)}}function e(t,s=100){let i;return(...h)=>{clearTimeout(i),i=setTimeout(()=>requestAnimationFrame(()=>{i=null,t(...h)}),s)}}class n{constructor(t,{event:s}){this.frame=t,this.B=!1,this._=s,this.k={$:this.$.bind(this),D:e(this.D.bind(this),1),I:this.I.bind(this)}}mount(){this._.s("touchstart mousedown",this.k.$,this.frame),this._.s("touchmove mousemove",this.k.D,this.frame,{passive:!1}),this._.s("touchend touchcancel mouseleave mouseup dragend",this.k.I,this.frame)}$(s){t(s),this.B||(this.N=this.S(s,{}),this.j=this.N,this._.v("dragstart",this.j))}D(s){t(s),this.N&&(this.j=this.S(s,this.N),this.B?(t(s),this._.v("drag",this.j)):this.C(this.j)&&(this._.v("drag",this.j),this.B=!0))}C({offset:t}){return 180*Math.atan(Math.abs(t.y)/Math.abs(t.x))/Math.PI<45}I(){this.N=null,this.B&&(this.O(this.j),this.B=!1)}O(t){const s=t.X.x;Math.abs(s)>0&&this._.v("dragend",this.j)}S(t,s){const{timeStamp:i,touches:h}=t,{clientX:e,clientY:n}=h?h[0]:t,{x:o=e,y:r=n}=s.q||{},c={x:e-o,y:n-r},a=i-(s.time||0),l={x:c.x/a,y:c.y/a};return{offset:c,X:l,q:{x:e,y:n},time:i,control:l.x<0?"next":"prev"}}}function o(t,{F:s,P:i}){const h=document.createElement(t);return h.className=s,h.innerHTML=i||"",h}function r(t){t&&t.parentElement&&t.parentElement.removeChild(t)}function c(t,s){t&&t.appendChild(s)}function a(t,s){t&&t.firstChild&&s&&t.insertBefore(s,t.firstChild)}function l(t,s,i=!1){i?t.classList.remove(s):t.classList.add(s)}function u(t,s){return Array(s-t+1).fill(0).map((s,i)=>t+i)}function d(t,s){return t>s?0:t<0?s:t}const v=()=>{};function f(t,s,i,h){return 0===t?t!==s:!(t!==i-1)&&s+1<h}function m(t,s,i){return s-i+t}class p{constructor(t,s,{U:i,V:h}={}){this.g=t,this.Y=s,this.G=0,this.H=t.querySelector(".virchual__pagination"),this.J=Math.min(s,null!=h?h:5),this.U=null!=i?i:16,this.K=Math.floor(this.J/2)}L(){this.H=o("div",{F:"virchual__pagination"}),this.H.style.width=this.J*this.U+"px",this.H.style.height=this.U+"px",u(0,Math.min(this.J,this.Y)-1).forEach(t=>{const s=f(t,t,this.J,this.Y),i=this.R(t,{W:s,Z:t===this.G});c(this.H,i)}),c(this.g,this.H)}next(){this.O(1)}prev(){this.O(-1)}O(t){this.G=d(this.G+t,this.Y-1);const s=(i=this.G,h=this.K,e=this.Y,i-Math.max(i-h,0)+Math.max(i-(-1+e-h),0));var i,h,e;const n=s===this.K&&this.G>this.K,o=n?1===t?0:this.J-1:-1;if([].slice.call(this.H.querySelectorAll("span")).forEach((i,h)=>{this.tt({st:i,index:h,sign:t,it:n,ht:o,et:s})}),n){const i=-1+this.J-o,h=f(i,m(i,this.G,s),this.J,this.Y),e=this.R(i,{W:h});this.nt(t,e)}}tt({st:t,index:s,et:i,sign:h,it:e,ht:n}){if(n===s)return r(t);const o=f(s-=e?h:0,m(s,this.G,i),this.J,this.Y);this.ot(t,{W:o,Z:s===i,position:e?s*this.U:void 0})}R(t,{Z:s,W:i}={}){const h=o("span",{F:"virchual__pagination-bullet"});return this.ot(h,{Z:s,W:i,position:t*this.U}),h}ot(t,{Z:s,W:i,position:h}){l(t,"virchual__pagination-bullet--active",!s),l(t,"virchual__pagination-bullet--edge",!i),null!=h&&(t.style.transform=`translateX(${h}px)`)}nt(t,s){(1===t?c:a)(this.H,s)}}class g{constructor(t,s,i){this.frame=s,this.p=i,this.rt=!1,this.Z=!1,this.ct=!1,"string"!=typeof t?(this.H=t,this.P=this.H.innerHTML,this.rt=!0):this.P=t}set(t,s){this[t]=s,this.ct=!0}L(){const t=o("div",{F:"virchual__slide",P:this.P});return this.ot(t),t}mount(t=!1){this.rt?this.ct&&this.update():(this.H=this.L(),this.rt=!0,this.H.addEventListener("transitionend",this.at),(t?a:c)(this.frame,this.H))}unmount(){this.rt=!1,r(this.H)}translate(t,{easing:s,done:i}={}){this.at=i||v,this.H.style.transition=`transform ${this.p.speed}ms ${s?this.p.easing:"ease"}`,this.H.style.transform=`translate3d(calc(${this.position}% + ${Math.round(t)}px), 0, 0)`}update(){this.ct=!1,this.ot(this.H)}ot(t){l(t,"virchual__slide--active",!this.Z),t.style.transform=`translate3d(${this.position}%, 0, 0)`}}function x(t,s,i){return[...u(s-i,s-1).map(s=>y(t,s)),t[s],...u(s+1,s+i).map(s=>y(t,s))]}function y(t,s){if(0===t.length)return;const i=s<0,h=s>t.length-1,e=i||h,n=h?-1:1,o=Math.max(Math.floor(Math.abs(s)/t.length),1);return e&&(s+=n*o*t.length),t[s]}return class extends class{constructor(t,i={}){let h;this.g=t,this.p=i,this.G=0,this.slides=[],this.lt=!1,this.frame=this.g.querySelector(".virchual__frame"),function(t){if(!t)throw new Error("Invalid element")}(this.frame),this.G=0,this.p=Object.assign({slides:[],speed:200,ut:150,dt:.6,vt:600,easing:"ease-out",ft:!0,window:1},i),this._=new s,this.k={T:this.T.bind(this),pt:this.pt.bind(this),gt:this.gt.bind(this)};const e=this.p.slides;h="function"==typeof e?e():e,this.slides=this.xt(),this.slides=this.slides.concat((h||[]).map(t=>new g(t,this.frame,this.p))),this.ft=new p(this.g,this.slides.length),this.ft.L()}register(t,s){new t({M:this,_:this._},s)}mount(){this._.v("mounted"),this.yt(),this.Mt(),new n(this.frame,{event:this._}).mount()}disable(){}enable(){}s(t,s){this._.s(t,s)}l(t){this._.l(t)}prev(){this.O("prev")}next(){this.O("next")}m(){this._.m(),this._.v("destroy")}O(t){this.slides[this.G].translate(-100,{easing:!0,done:()=>{this.lt=!1}});const s="prev"===t?-1:1;this.G=d(this.G+1*s,this.slides.length-1),this.yt({control:t}),("prev"===t?this.ft.prev.bind(this.ft):this.ft.next.bind(this.ft))()}xt(){return[].slice.call(this.frame.querySelectorAll("div")).map(t=>new g(t,this.frame,this.p))}yt({control:t}={}){const s=this.slides[this.G],i=u(0,this.slides.length-1),h=this.p.window,e=x(i,this.G,h);x(i,this.G,h+1).forEach(i=>{const n=this.slides[i];i===this.G?s.set("isActive",!0):s.set("isActive",!1);const o=e.indexOf(i);if(o<0)return n.unmount();n.set("position",-100*(h-o));const r="prev"===t||null==t&&this.slides[0].rt&&o-h<0;n.mount(r)})}Mt(){this._.s("drag",this.k.pt),this._.s("dragend",this.k.gt),this._.s("click",this.k.T,this.frame,{capture:!0})}T(s){this.lt&&t(s)}pt(t){this.lt=!0;const s=x(u(0,this.slides.length-1),this.G,this.p.window),i="prev"===t.control?1:-1;s.forEach(s=>{const h=this.slides[s],e=i*Math.abs(t.offset.x);h.translate(e)})}gt(t){this.O(t.control)}}{constructor(t,s={}){super(t,s),this.register(i,{isEnabled:!0}),this.register(h,{threshold:300})}}}));
//# sourceMappingURL=virchual.bundle.min.js.map
