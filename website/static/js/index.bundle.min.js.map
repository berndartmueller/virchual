{"version":3,"file":"index.bundle.min.js","sources":["../src/utils/debouncer.ts","../src/utils/event.ts","../src/drag.ts","../src/utils/dom.ts","../src/utils/utils.ts","../src/pagination.ts","../src/slide.ts","../src/utils/sliding-window.ts","../src/components/controls/controls.ts","../src/components/lazy/lazy.ts","../src/virchual.ts","../src/utils/error.ts","../entry/entry-complete.ts"],"sourcesContent":["/**\n * Handles debouncing of events via requestAnimationFrame\n *\n * @param callback The callback to handle whichever event\n */\nexport function debounce(callback: (...args: unknown[]) => unknown, delay = 100) {\n  let timeoutId: NodeJS.Timeout;\n\n  return (...args: unknown[]) => {\n    clearTimeout(timeoutId);\n\n    timeoutId = setTimeout(\n      () =>\n        requestAnimationFrame(() => {\n          timeoutId = null;\n\n          callback(...args);\n        }),\n      delay,\n    );\n  };\n}\n","export function stop(event: MouseEvent | TouchEvent) {\n  if (!event) return;\n\n  event.stopImmediatePropagation();\n  event.stopPropagation();\n  event.preventDefault();\n}\n\nexport class Event {\n  /**\n   * Store all event this.data.\n   */\n  private handlers: Array<{\n    event: string;\n    handler: (...args: unknown[]) => void;\n    elm: (Window & typeof globalThis) | Element;\n    opts: boolean | AddEventListenerOptions;\n  }> = [];\n\n  /**\n   * Subscribe the given event(s).\n   *\n   * @param events  - An event name. Use space to separate multiple events.\n   *                  Also, namespace is accepted by dot, such as 'resize.{namespace}'.\n   * @param handler - A callback function.\n   * @param element - Optional. Native event will be listened to when this arg is provided.\n   * @param opts - Optional. Options for addEventListener.\n   */\n  on(\n    events: string,\n    handler: (...args: unknown[]) => void,\n    element?: (Window & typeof globalThis) | Element,\n    opts: boolean | AddEventListenerOptions = {},\n  ) {\n    events.split(' ').forEach(event => {\n      element && element.addEventListener(event, handler, opts);\n\n      this.handlers.push({ event, handler, elm: element, opts: opts });\n    });\n  }\n\n  /**\n   * Unsubscribe the given event(s).\n   *\n   * @param events - A event name or names split by space.\n   * @param element - Optional. removeEventListener() will be called when this arg is provided.\n   */\n  off(events: string, element?: (Window & typeof globalThis) | Element) {\n    events.split(' ').forEach(event => {\n      this.handlers = this.handlers.filter(item => {\n        if (item && item.event === event && item.elm === element) {\n          this.unroll(item);\n        }\n      });\n    });\n  }\n\n  /**\n   * Emit an event.\n   * This method is only for custom events.\n   *\n   * @param event - An event name.\n   * @param args  - Any number of arguments passed to handlers.\n   */\n  emit(event: string, ...args: unknown[]) {\n    this.handlers.forEach(item => {\n      if (!item.elm && item.event.split('.')[0] === event) {\n        item.handler(...args);\n      }\n    });\n  }\n\n  /**\n   * Clear event this.data.\n   */\n  destroy() {\n    this.handlers.forEach(this.unroll);\n    this.handlers = [];\n  }\n\n  /**\n   * Remove the registered event listener.\n   *\n   * @param item - An object containing event this.data.\n   */\n  private unroll(item) {\n    item.elm && item.elm.removeEventListener(item.event, item.handler, item.opts);\n  }\n}\n","import { identity } from './types';\nimport { debounce } from './utils/debouncer';\nimport { Event, stop } from './utils/event';\n\nexport class Drag {\n  // Analyzed info on starting drag.\n  private startInfo;\n\n  // Analyzed info being updated while dragging/swiping.\n  private currentInfo;\n\n  // Determine whether slides are being dragged or not.\n  private isDragging = false;\n\n  private eventBus: Event;\n\n  // bound event handlers (to keep `this` context)\n  private eventBindings: {\n    onStart: identity;\n    onMove: identity;\n    onEnd: identity;\n  };\n\n  constructor(private frame: HTMLElement, { event }: { event: Event }) {\n    this.eventBus = event;\n\n    this.eventBindings = {\n      onStart: this.onStart.bind(this),\n      onMove: debounce(this.onMove.bind(this), 1),\n      onEnd: this.onEnd.bind(this),\n    };\n  }\n\n  mount() {\n    this.eventBus.on('touchstart mousedown', this.eventBindings.onStart, this.frame);\n    this.eventBus.on('touchmove mousemove', this.eventBindings.onMove, this.frame, { passive: false });\n    this.eventBus.on('touchend touchcancel mouseleave mouseup dragend', this.eventBindings.onEnd, this.frame);\n  }\n\n  /**\n   * Called when the track starts to be dragged.\n   */\n  private onStart(event: MouseEvent & TouchEvent) {\n    stop(event);\n\n    if (!this.isDragging) {\n      this.startInfo = this.analyze(event, {});\n\n      this.currentInfo = this.startInfo;\n\n      this.eventBus.emit('dragstart', this.currentInfo);\n    }\n  }\n\n  private onMove(event: MouseEvent & TouchEvent) {\n    stop(event);\n\n    if (!this.startInfo) {\n      return;\n    }\n\n    this.currentInfo = this.analyze(event, this.startInfo);\n\n    if (this.isDragging) {\n      stop(event);\n\n      this.eventBus.emit('drag', this.currentInfo);\n    } else {\n      if (this.shouldMove(this.currentInfo)) {\n        this.eventBus.emit('drag', this.currentInfo);\n\n        this.isDragging = true;\n      }\n    }\n  }\n\n  /**\n   * Determine whether to start moving the track or not by drag angle.\n   *\n   * @param info - An information object.\n   *\n   * @return True if the track should be moved or false if not.\n   */\n  private shouldMove({ offset }) {\n    const angle = (Math.atan(Math.abs(offset.y) / Math.abs(offset.x)) * 180) / Math.PI;\n\n    const dragAngleThreshold = 45;\n\n    return angle < dragAngleThreshold;\n  }\n\n  /**\n   * Called when dragging ends.\n   */\n  private onEnd() {\n    this.startInfo = null;\n\n    if (this.isDragging) {\n      this.goTo(this.currentInfo);\n\n      this.isDragging = false;\n    }\n  }\n\n  /**\n   * Go to the slide determined by the analyzed data.\n   *\n   * @param info - An info object.\n   */\n  private goTo(info) {\n    const velocity = info.velocity['x'];\n    const absV = Math.abs(velocity);\n\n    if (absV > 0) {\n      this.eventBus.emit('dragend', this.currentInfo);\n    }\n  }\n\n  /**\n   * Analyze the given event object and return important information for handling swipe behavior.\n   *\n   * @param event          - Touch or Mouse event object.\n   * @param startInfo  - Information analyzed on start for calculating difference from the current one.\n   *\n   * @return - An object containing analyzed information, such as offset, velocity, etc.\n   */\n  private analyze(\n    event: MouseEvent & TouchEvent,\n    startInfo,\n  ): {\n    to: { x: number; y: number };\n    offset: { x: number; y: number };\n    velocity: { x: number; y: number };\n    time: number;\n    control: 'prev' | 'next';\n  } {\n    const { timeStamp, touches } = event;\n    const { clientX, clientY } = touches ? touches[0] : event;\n    const { x: fromX = clientX, y: fromY = clientY } = startInfo.to || {};\n\n    const startTime = startInfo.time || 0;\n    const offset = { x: clientX - fromX, y: clientY - fromY };\n    const duration = timeStamp - startTime;\n    const velocity = { x: offset.x / duration, y: offset.y / duration };\n\n    return {\n      offset,\n      velocity,\n      to: { x: clientX, y: clientY },\n      time: timeStamp,\n      control: velocity.x < 0 ? 'next' : 'prev',\n    };\n  }\n}\n","export function createElement(tagName: string, { classNames, html }: { classNames?: string; html?: string }) {\n  const element = document.createElement(tagName);\n\n  element.className = classNames;\n  element.innerHTML = html || '';\n\n  return element;\n}\n\n/**\n * Remove a given element from a DOM tree.\n *\n * @param elms - Element(s) to be removed.\n */\nexport function remove(element: HTMLElement) {\n  if (element && element.parentElement) {\n    element.parentElement.removeChild(element);\n  }\n}\n\n/**\n * Append a child to a given element.\n *\n * @param parent - A parent element.\n * @param child  - An element to be appended.\n */\nexport function append(parent: HTMLElement, child: HTMLElement) {\n  if (parent) {\n    parent.appendChild(child);\n  }\n}\n\n/**\n * Prepend an element to parent.\n *\n * @param element- An element to prepend.\n * @param element - A reference element.\n */\nexport function prepend(parent: HTMLElement, element: HTMLElement) {\n  if (parent && parent.firstChild && element) {\n    parent.insertBefore(element, parent.firstChild);\n  }\n}\n\n/**\n * Add or remove css class to given element.\n *\n * @param element Element to add class tp.\n * @param klass CSS classname.\n * @param remove Remove class instead of adding.\n */\nexport function addOrRemoveClass(element: HTMLElement, klass: string, remove = false) {\n  if (!remove) {\n    element.classList.add(klass);\n\n    return;\n  }\n\n  element.classList.remove(klass);\n}\n","export function range(start: number, end: number): number[] {\n  return Array(end - start + 1)\n    .fill(0)\n    .map((_, idx) => start + idx);\n}\n\n/*\n * Rewind the given index if it's out of range.\n *\n * @param index - An index.\n * @param edge - Edge\n *\n * @return A rewound index.\n */\nexport function rewind(index: number, edge: number): number {\n  if (index > edge) {\n    return 0;\n  }\n\n  if (index < 0) {\n    return edge;\n  }\n\n  return index;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nexport const noop = () => {};\n","import { Sign } from './types';\nimport { addOrRemoveClass, append, prepend, remove, createElement } from './utils/dom';\nimport { range, rewind } from './utils/utils';\n\n/**\n * Map current index to bullet elements index.\n *\n * @param index Current index.\n * @param center Center index of bullets (5 bullets -> center: 2).\n * @param total Total bullets. Same as amount of slides.\n */\nexport function mapActiveIndex(index: number, center: number, total: number) {\n  return index - Math.max(index - center, 0) + Math.max(index - (-1 + total - center), 0);\n}\n\n/**\n * Return true if bullet is edge bullet.\n *\n * @param index Index of bullet.\n * @param realIndex Real slide index which bullet represents.\n * @param bullets Amount of shown bullets.\n * @param total Total bullets. Same as amount of slides.\n */\nexport function isEdgeBullet(index: number, realIndex: number, bullets: number, total: number) {\n  const isRightEdge = index === bullets - 1;\n\n  // bullet is either left or right edge\n  if (index === 0) {\n    return index !== realIndex;\n  }\n\n  if (isRightEdge) {\n    return realIndex + 1 < total;\n  }\n\n  return false;\n}\n\n/**\n * Get real index of bullet.\n *\n * @param index Index of bullet.\n * @param currentIndex Current active index.\n * @param activeBulletIndex Index of active bullet element.\n */\nfunction getRealIndex(index: number, currentIndex: number, activeBulletIndex: number) {\n  return currentIndex - activeBulletIndex + index;\n}\n\nexport class Pagination {\n  private ref: HTMLElement;\n  private currentIndex = 0;\n  private centerIndex: number;\n\n  constructor(private container: HTMLElement, private len: number, private settings: { diameter?: number; bullets?: number } = {}) {\n    this.ref = container.querySelector('.virchual__pagination');\n\n    this.settings = {\n      bullets: 5,\n      diameter: 16,\n      ...settings,\n    };\n\n    this.centerIndex = Math.floor(this.settings['bullets'] / 2);\n  }\n\n  render() {\n    const bullets = this.settings['bullets'];\n    const diameter = this.settings['diameter'];\n\n    this.ref = createElement('div', { classNames: 'virchual__pagination' });\n\n    this.ref.style.width = `${bullets * diameter}px`;\n    this.ref.style.height = `${diameter}px`;\n\n    range(0, Math.min(bullets, this.len) - 1).forEach(index => {\n      const isEdge = isEdgeBullet(index, index, bullets, this.len);\n\n      const bullet = this.renderBullet(index, { isEdge, isActive: index === this.currentIndex });\n\n      append(this.ref, bullet);\n    });\n\n    append(this.container, this.ref);\n  }\n\n  next() {\n    this.goTo(+1);\n  }\n\n  prev() {\n    this.goTo(-1);\n  }\n\n  private goTo(sign: Sign) {\n    const bulletsLength = this.settings['bullets'];\n\n    this.currentIndex = rewind(this.currentIndex + sign, this.len - 1);\n\n    const mappedActiveIndex = mapActiveIndex(this.currentIndex, this.centerIndex, this.len);\n    const removeBullet = mappedActiveIndex === this.centerIndex && this.currentIndex > this.centerIndex;\n    const removeBulletIndex = removeBullet ? (sign === 1 ? 0 : bulletsLength - 1) : -1;\n\n    const bullets = [].slice.call(this.ref.querySelectorAll('span')) as HTMLElement[];\n\n    bullets.forEach((bullet, index) => {\n      this.handleBulletMovement({ bullet, index, sign, removeBullet, removeBulletIndex, activeIndex: mappedActiveIndex });\n    });\n\n    // append or prepend new bullet\n    if (removeBullet) {\n      const insertBulletIndex = -1 + bulletsLength - removeBulletIndex;\n      const realIndex = getRealIndex(insertBulletIndex, this.currentIndex, mappedActiveIndex);\n      const isEdge = isEdgeBullet(insertBulletIndex, realIndex, bulletsLength, this.len);\n\n      const bullet = this.renderBullet(insertBulletIndex, { isEdge });\n\n      this.insertBullet(sign, bullet);\n    }\n  }\n\n  private handleBulletMovement({\n    bullet,\n    index,\n    activeIndex,\n    sign,\n    removeBullet,\n    removeBulletIndex,\n  }: {\n    bullet: HTMLElement;\n    index: number;\n    activeIndex: number;\n    sign: Sign;\n    removeBullet: boolean;\n    removeBulletIndex: number;\n  }) {\n    if (removeBulletIndex === index) {\n      return remove(bullet);\n    }\n\n    // shift index due to remove bullet\n    index = index - (removeBullet ? sign : 0);\n\n    const realIndex = getRealIndex(index, this.currentIndex, activeIndex);\n    const isEdge = isEdgeBullet(index, realIndex, this.settings['bullets'], this.len);\n\n    this.setAttributes(bullet, {\n      isEdge,\n      isActive: index === activeIndex,\n      position: removeBullet ? index * this.settings['diameter'] : undefined,\n    });\n  }\n\n  private renderBullet(index: number, { isActive, isEdge }: { isActive?: boolean; isEdge?: boolean } = {}) {\n    const element = createElement('span', { classNames: 'virchual__pagination-bullet' });\n\n    this.setAttributes(element, { isActive, isEdge, position: index * this.settings['diameter'] });\n\n    return element;\n  }\n\n  private setAttributes(bullet: HTMLElement, { isActive, isEdge, position }: { isActive: boolean; isEdge: boolean; position?: number }) {\n    addOrRemoveClass(bullet, 'virchual__pagination-bullet--active', !isActive);\n    addOrRemoveClass(bullet, 'virchual__pagination-bullet--edge', !isEdge);\n\n    if (position != null) {\n      bullet.style.transform = `translateX(${position}px)`;\n    }\n  }\n\n  private insertBullet(sign: Sign, bullet: HTMLElement) {\n    const insert = sign === 1 ? append : prepend;\n\n    insert(this.ref, bullet);\n  }\n}\n","import { identity } from './types';\nimport { addOrRemoveClass, append, prepend as prependFn, remove, createElement } from './utils/dom';\nimport { noop } from './utils/utils';\nimport { VirchualSettings } from './virchual';\n\n/**\n * Virtual slide component.\n */\nexport class Slide {\n  isMounted = false;\n  isActive = false;\n  position: number;\n\n  private hasChanged = false;\n  private html: string;\n  private ref: HTMLElement;\n  private transitionEndCallback: identity;\n\n  constructor(html: string | HTMLElement, private frame: HTMLElement, private settings: VirchualSettings) {\n    if (typeof html === 'string') {\n      this.html = html;\n\n      return;\n    }\n\n    this.ref = html;\n    this.html = this.ref.innerHTML;\n    this.isMounted = true;\n  }\n\n  set<T extends Extract<keyof this, 'isActive' | 'position'>>(property: T, value: this[T]) {\n    this[property] = value;\n\n    this.hasChanged = true;\n  }\n\n  render(): HTMLElement {\n    const element = createElement('div', { classNames: 'virchual__slide', html: this.html });\n\n    this.setAttributes(element);\n\n    return element;\n  }\n\n  mount(prepend = false) {\n    if (this.isMounted) {\n      // slide has changed -> update in DOM\n      if (this.hasChanged) {\n        this.update();\n      }\n\n      return;\n    }\n\n    console.debug('[Mount] Slide', { ref: this.ref, prepend });\n\n    this.ref = this.render();\n\n    this.isMounted = true;\n\n    this.ref.addEventListener('transitionend', this.transitionEndCallback);\n\n    const insert = prepend ? prependFn : append;\n\n    insert(this.frame, this.ref);\n  }\n\n  unmount() {\n    console.debug('[Unmount] Slide', { ref: this.ref });\n\n    this.isMounted = false;\n\n    remove(this.ref);\n  }\n\n  /**\n   * Start transition.\n   *\n   * @param value Position to translate to.\n   * @param easing Enable or disable transition easing.\n   * @param done Callback function after transition has ended.\n   */\n  translate(value: number, { easing, done }: { easing?: boolean; done?: identity } = {}) {\n    this.transitionEndCallback = done || noop;\n\n    this.ref.style.transition = `transform ${this.settings['speed']}ms ${easing ? this.settings['easing'] : 'ease'}`;\n    this.ref.style.transform = `translate3d(calc(${this.position}% + ${Math.round(value)}px), 0, 0)`;\n  }\n\n  private update() {\n    this.hasChanged = false;\n\n    this.setAttributes(this.ref);\n  }\n\n  private setAttributes(element: HTMLElement) {\n    addOrRemoveClass(element, 'virchual__slide--active', !this.isActive);\n\n    element.style.transform = `translate3d(${this.position}%, 0, 0)`;\n  }\n}\n","import { range } from './utils';\n\n/**\n * Returns a sliding window section of an array.\n *\n * @param source Source array.\n * @param start The start of the specified portion of the array. Acts as the center of the sliding window.\n * @param len The window size/length. Specifies how many items the window has on each sides.\n */\nexport function slidingWindow(source: number[], start: number, len: number): number[] {\n  const left = range(start - len, start - 1).map(index => get(source, index));\n  const center = [source[start]];\n  const right = range(start + 1, start + len).map(index => get(source, index));\n\n  const window = [...left, ...center, ...right];\n\n  return window;\n}\n\n/**\n * Get array item by index.\n *\n * Returning items from the end of the source array when accessing negative indexes or\n * from the start of source array when accessing out of range indexes.\n *\n * @param source Source array.\n * @param index Index of array item to access.\n */\nexport function get<T>(source: T[], index: number): T {\n  if (source.length === 0) {\n    return;\n  }\n\n  const isOutOfLowerBounds = index < 0;\n  const isOutOfUpperBounds = index > source.length - 1;\n  const isOutOfBounds = isOutOfLowerBounds || isOutOfUpperBounds;\n\n  const sign = isOutOfUpperBounds ? -1 : +1;\n  const multiple = Math.max(Math.floor(Math.abs(index) / source.length), 1);\n\n  if (isOutOfBounds) {\n    index += sign * multiple * source.length;\n  }\n\n  return source[index];\n}\n","import { identity } from '../../types';\nimport { stop } from '../../utils/event';\nimport { ComponentDependencies } from './../component';\n\nexport class Controls {\n  private controls: HTMLButtonElement[];\n  private onClickBound: () => identity;\n\n  constructor(private imports: ComponentDependencies, private settings?: { isEnabled?: boolean }) {\n    this.controls = [].slice.call(imports.virchual.container.querySelectorAll('.virchual__control'));\n\n    imports.eventBus.on('destroy', () => {\n      console.log('controls component destroy');\n    });\n\n    this.onClickBound = this.onClick.bind(this);\n\n    this.mount();\n  }\n\n  mount(): void {\n    this.controls.forEach(button => this.imports.eventBus.on('click', this.onClickBound, button));\n  }\n\n  private onClick(event: MouseEvent) {\n    stop(event);\n\n    const button: HTMLButtonElement = (event.target as Element).closest('button') as HTMLButtonElement;\n    const control = button.dataset.controls as 'prev' | 'next';\n\n    if (control === 'prev') {\n      this.imports.virchual.prev();\n\n      return;\n    }\n\n    this.imports.virchual.next();\n  }\n}\n","import { ComponentDependencies } from './../component';\n\nexport type LazySettings = {\n  threshold?: number;\n};\n\nexport class Lazy {\n  constructor(private imports: ComponentDependencies, private settings?: { threshold?: number }) {\n    this.settings = {\n      threshold: 300,\n      ...settings,\n    };\n\n    this.imports.virchual.mount();\n  }\n}\n","import { ComponentConstructor } from './components/component';\nimport { Drag } from './drag';\nimport { Pagination } from './pagination';\nimport { Slide } from './slide';\nimport { identity, Sign } from './types';\nimport { assert } from './utils/error';\nimport { Event, stop } from './utils/event';\nimport { slidingWindow } from './utils/sliding-window';\nimport { range, rewind } from './utils/utils';\n\nexport type VirchualSettings = {\n  slides?: string[] | (() => string[]);\n  speed?: number;\n  easing?: string;\n  swipeDistanceThreshold?: number;\n  flickVelocityThreshold?: number;\n  flickPower?: number;\n  pagination?: boolean;\n  window?: number;\n};\n\nexport class Virchual {\n  frame: HTMLElement;\n  currentIndex = 0;\n\n  private slides: Slide[] = [];\n  private eventBus: Event;\n  private isBusy = false;\n  private pagination: Pagination;\n\n  private eventBindings: {\n    onClick: () => identity;\n    onDrag: () => identity;\n    onDragEnd: () => identity;\n  };\n\n  constructor(public container: HTMLElement, public settings: VirchualSettings = {}) {\n    this.frame = this.container.querySelector('.virchual__frame');\n\n    assert(this.frame, 'Invalid element');\n\n    this.currentIndex = 0;\n    this.settings = {\n      slides: [],\n      speed: 200,\n      swipeDistanceThreshold: 150,\n      flickVelocityThreshold: 0.6,\n      flickPower: 600,\n      easing: 'ease-out',\n      pagination: true,\n      window: 1,\n      ...settings,\n    };\n\n    this.eventBus = new Event();\n\n    this.eventBindings = {\n      onClick: this.onClick.bind(this),\n      onDrag: this.onDrag.bind(this),\n      onDragEnd: this.onDragEnd.bind(this),\n    };\n\n    let rawSlides;\n\n    const slides = this.settings['slides'];\n\n    if (typeof slides === 'function') {\n      rawSlides = slides();\n    } else {\n      rawSlides = slides;\n    }\n\n    this.slides = this.hydrate();\n\n    this.slides = this.slides.concat((rawSlides || []).map(slide => new Slide(slide, this.frame, this.settings)));\n\n    this.pagination = new Pagination(this.container, this.slides.length);\n\n    this.pagination.render();\n  }\n\n  /**\n   * Register component class.\n   *\n   * @param cls Component class.\n   * @param settings Optional settings.\n   */\n  register<T, U>(cls: ComponentConstructor<T, U>, settings?: U) {\n    new cls({ virchual: this, eventBus: this.eventBus }, settings);\n  }\n\n  /**\n   * Mount components.\n   */\n  mount() {\n    console.debug('[Mount] Virchual');\n\n    this.eventBus.emit('mounted');\n\n    this.mountAndUnmountSlides();\n\n    this.bindEvents();\n\n    new Drag(this.frame, { event: this.eventBus }).mount();\n  }\n\n  /**\n   * Disable Virchual instance and all user interactions (changing slides)\n   *\n   * @TODO\n   */\n  disable() {\n    return;\n  }\n\n  /**\n   * Enable previously disabled Virchual instance. Enable user interaction.\n   *\n   * @TODO\n   */\n  enable() {\n    return;\n  }\n\n  /**\n   * Register callback fired on the given event(s).\n   *\n   * @param events An event name. Use space to separate multiple events.\n   *                             Also, namespace is accepted by dot, such as 'resize.{namespace}'.\n   * @param handler A callback function.\n   * @param elm  Optional. Native event will be listened to when this arg is provided.\n   * @param opts Optional. Options for addEventListener.\n   */\n  on(events: string, handler: identity) {\n    this.eventBus.on(events, handler);\n  }\n\n  /**\n   * Unsubscribe the given event.\n   *\n   * @param events - A event name.\n   * @param elm    - Optional. removeEventListener() will be called when this arg is provided.\n   */\n  off(events: string) {\n    this.eventBus.off(events);\n  }\n\n  /**\n   * Go to previous slide.\n   */\n  prev() {\n    console.debug('[Controls] Previous');\n\n    this.goTo('prev');\n  }\n\n  /**\n   * Go to next slide.\n   */\n  next() {\n    console.debug('[Controls] Next');\n\n    this.goTo('next');\n  }\n\n  /**\n   * Destroy instance, remove DOM events.\n   */\n  destroy() {\n    this.eventBus.destroy();\n\n    this.eventBus.emit('destroy');\n  }\n\n  private goTo(control: 'prev' | 'next') {\n    const slide = this.slides[this.currentIndex];\n\n    slide.translate(-100, {\n      easing: true,\n      done: () => {\n        this.isBusy = false;\n      },\n    });\n\n    const sign: Sign = control === 'prev' ? -1 : +1;\n\n    this.currentIndex = rewind(this.currentIndex + sign * 1, this.slides.length - 1);\n\n    this.mountAndUnmountSlides({ control: control });\n\n    const move = control === 'prev' ? this.pagination.prev.bind(this.pagination) : this.pagination.next.bind(this.pagination);\n\n    move();\n  }\n\n  private hydrate(): Slide[] {\n    const slideElements = [].slice.call(this.frame.querySelectorAll('div')) as HTMLDivElement[];\n\n    return slideElements.map(element => new Slide(element, this.frame, this.settings));\n  }\n\n  /**\n   * Mount and unmount slides.\n   */\n  private mountAndUnmountSlides({ control }: { control?: 'prev' | 'next' } = {}) {\n    const currentSlide = this.slides[this.currentIndex];\n    const indices = range(0, this.slides.length - 1);\n    const window = this.settings['window'];\n\n    const mountableSlideIndices = slidingWindow(indices, this.currentIndex, window);\n    const mountableSlideIndicesWithOffset = slidingWindow(indices, this.currentIndex, window + 1);\n\n    mountableSlideIndicesWithOffset.forEach(index => {\n      const slide = this.slides[index];\n\n      if (index === this.currentIndex) {\n        currentSlide.set('isActive', true);\n      } else {\n        currentSlide.set('isActive', false);\n      }\n\n      const realIndex = mountableSlideIndices.indexOf(index);\n\n      // unmount\n      if (realIndex < 0) {\n        return slide.unmount();\n      }\n\n      slide.set('position', (window - realIndex) * -100);\n\n      const prepend = control === 'prev' || (control == null && this.slides[0].isMounted && realIndex - window < 0);\n\n      slide.mount(prepend);\n    });\n  }\n\n  private bindEvents() {\n    this.eventBus.on('drag', this.eventBindings.onDrag);\n    this.eventBus.on('dragend', this.eventBindings.onDragEnd);\n    this.eventBus.on('click', this.eventBindings.onClick, this.frame, { capture: true });\n  }\n\n  /**\n   * Called when frame is clicked.\n   *\n   * @param event A click event.\n   */\n  private onClick(event: MouseEvent) {\n    this.isBusy && stop(event);\n  }\n\n  /**\n   * Handle drag event.\n   *\n   * @param event\n   */\n  private onDrag(event: { offset: { x: number; y: number }; control: 'prev' | 'next' }) {\n    this.isBusy = true;\n\n    const mountableSlideIndices = slidingWindow(range(0, this.slides.length - 1), this.currentIndex, this.settings['window']);\n\n    const sign = event.control === 'prev' ? +1 : -1;\n\n    mountableSlideIndices.forEach(index => {\n      const slide = this.slides[index];\n\n      const x = sign * Math.abs(event.offset.x);\n\n      slide.translate(x);\n    });\n  }\n\n  /**\n   * Handle dragged event.\n   *\n   * @param event\n   */\n  private onDragEnd(event: { control: 'prev' | 'next' }) {\n    console.debug('[Drag] Drag end', event);\n\n    this.goTo(event.control);\n  }\n}\n","/**\n * Check existence of the given object and throw an error if it doesn't.\n *\n * @throws {Error}\n *\n * @param subject - A subject to be confirmed.\n * @param message - An error message.\n */\nexport function assert<T extends unknown>(subject: T, message: string) {\n  if (!subject) {\n    throw new Error(message);\n  }\n}\n","import { Virchual as VirchualCore, VirchualSettings } from './../src/virchual';\nimport { Controls } from './../src/components/controls';\nimport { Lazy } from './../src/components/lazy';\n\nexport default class Virchual extends VirchualCore {\n  constructor(public container: HTMLElement, public settings: VirchualSettings = {}) {\n    super(container, settings);\n\n    this.register(Controls, { isEnabled: true });\n    this.register(Lazy, { threshold: 300 });\n  }\n}\n"],"names":["debounce","callback","delay","timeoutId","args","clearTimeout","setTimeout","requestAnimationFrame","stop","event","stopImmediatePropagation","stopPropagation","preventDefault","Event","[object Object]","this","events","handler","element","opts","split","forEach","addEventListener","handlers","push","i","h","o","filter","item","elm","unroll","removeEventListener","Drag","frame","eventBus","eventBindings","_","onStart","bind","A","onMove","T","onEnd","on","passive","isDragging","startInfo","analyze","currentInfo","emit","shouldMove","offset","Math","atan","abs","y","x","PI","goTo","info","velocity","timeStamp","touches","clientX","clientY","fromX","fromY","to","duration","time","j","N","control","createElement","tagName","S","classNames","C","html","document","className","innerHTML","remove","parentElement","removeChild","append","parent","child","appendChild","prepend","firstChild","insertBefore","addOrRemoveClass","klass","classList","add","range","start","end","Array","fill","map","idx","rewind","index","edge","noop","isEdgeBullet","realIndex","bullets","total","getRealIndex","currentIndex","activeBulletIndex","Pagination","container","len","settings","ref","querySelector","diameter","centerIndex","floor","style","width","height","min","isEdge","bullet","renderBullet","G","H","sign","bulletsLength","mappedActiveIndex","center","max","removeBullet","removeBulletIndex","slice","call","querySelectorAll","handleBulletMovement","K","L","R","W","insertBulletIndex","insertBullet","activeIndex","setAttributes","position","undefined","isActive","transform","Slide","isMounted","property","value","hasChanged","update","render","transitionEndCallback","prependFn","easing","done","transition","round","slidingWindow","source","get","length","isOutOfLowerBounds","isOutOfUpperBounds","isOutOfBounds","multiple","Controls","imports","controls","virchual","onClickBound","onClick","mount","button","target","closest","dataset","next","prev","Lazy","threshold","rawSlides","subject","Error","assert","slides","speed","ct","at","lt","ut","window","ot","dt","onDrag","vt","onDragEnd","hydrate","concat","slide","pagination","cls","et","g","mountAndUnmountSlides","bindEvents","off","destroy","translate","isBusy","currentSlide","indices","mountableSlideIndices","set","indexOf","unmount","capture","super","register","isEnabled"],"mappings":"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"}